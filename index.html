<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="google-site-verification" content="woSU6QVUGPoORJDYtwucfPKg5yCxgi2v5F5CN_H1hdg" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>InfiniScan | Google Sheets Contact</title>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- jsPDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            --card-bg: rgba(255, 255, 255, 0.07);
            --card-border: rgba(255, 255, 255, 0.12);
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --accent: #06b6d4;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --danger: #ef4444;
            --spacing-unit: clamp(1rem, 2vw, 2rem);
            --radius: 16px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-gradient); color: var(--text-main); min-height: 100vh; display: flex; flex-direction: column; overflow-x: hidden; }
        .container { width: 100%; max-width: 1000px; margin: 0 auto; padding: var(--spacing-unit); flex: 1; display: flex; flex-direction: column; }
        header { text-align: center; margin-bottom: 2rem; }
        h1 { font-size: 2.5rem; font-weight: 800; background: linear-gradient(to right, #60a5fa, #22d3ee); -webkit-background-clip: text; background-clip: text; color: transparent; }

        .view-section { display: none; width: 100%; flex-direction: column; align-items: center; animation: fadeIn 0.3s ease; }
        .view-section.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .upload-box { width: 100%; max-width: 500px; border: 2px dashed var(--card-border); border-radius: var(--radius); padding: 3rem 1rem; text-align: center; background: var(--card-bg); cursor: pointer; transition: 0.3s; margin-bottom: 1.5rem; }
        .upload-box.dragover { border-color: var(--primary); background: rgba(59, 130, 246, 0.1); }
        
        /* Advertisement Box Styling */
        .ad-placeholder { 
            width: 100%; 
            max-width: 500px; 
            min-height: 100px;
            background: rgba(0, 0, 0, 0.2); 
            border: 1px solid var(--card-border); 
            border-radius: var(--radius); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            position: relative;
            overflow: hidden;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .ad-label {
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 9px;
            color: var(--text-muted);
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        .ad-content {
            width: 100%;
            padding: 1rem;
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 1rem; width: 100%; margin-bottom: 2rem; }
        .image-card { background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 12px; overflow: hidden; position: relative; aspect-ratio: 3/4; cursor: grab; transition: 0.2s; user-select: none; }
        .img-preview { width: 100%; height: 100%; object-fit: cover; pointer-events: none; }
        .card-overlay { position: absolute; top: 0; left: 0; right: 0; padding: 8px; display: flex; justify-content: space-between; background: linear-gradient(to bottom, rgba(0,0,0,0.5), transparent); }
        .btn-delete { background: var(--danger); border: none; color: white; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; }

        .action-bar { position: sticky; bottom: 1.5rem; background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px); padding: 1rem 1.5rem; border-radius: 20px; display: flex; flex-direction: column; gap: 0.8rem; border: 1px solid var(--card-border); z-index: 100; width: 100%; max-width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .action-buttons-row { display: flex; gap: 10px; width: 100%; }
        
        .btn { padding: 0.8rem 1.5rem; border-radius: 12px; border: none; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; text-transform: uppercase; font-size: 0.9rem; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; flex: 2; }
        .btn-primary:hover { background: var(--primary-hover); }
        .btn-outline { background: transparent; border: 1px solid var(--card-border); color: var(--text-main); flex: 1; }
        .btn-add-more { background: rgba(255, 255, 255, 0.05); border: 1px dashed var(--accent); color: var(--accent); width: 100%; }
        
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(8px); z-index: 1000; display: none; align-items: center; justify-content: center; padding: 20px; }
        .modal-overlay.active { display: flex; }
        .modal-content { background: #1e293b; border: 1px solid var(--card-border); border-radius: 24px; width: 100%; max-width: 600px; max-height: 85vh; overflow-y: auto; padding: 2.5rem; position: relative; }
        .modal-close { position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.1); border: none; color: var(--text-main); width: 35px; height: 35px; border-radius: 50%; cursor: pointer; }

        .form-group { margin-bottom: 1.2rem; text-align: left; }
        .form-group label { display: block; margin-bottom: 5px; font-size: 0.85rem; }
        .form-input { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid var(--card-border); background: rgba(0,0,0,0.2); color: white; outline: none; }
        .btn-form-trigger { margin-top: 20px; width: 100%; background: var(--accent); color: white; padding: 15px; border-radius: 12px; font-weight: bold; }

        footer { padding: 2.5rem 1.5rem; text-align: center; font-size: 0.85rem; color: var(--text-muted); border-top: 1px solid var(--card-border); }
        .footer-nav { margin-top: 12px; display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .footer-nav span { cursor: pointer; font-weight: 500; }
        .footer-nav span:hover { color: var(--primary); }
        
        /* Updated Footer Link Style */
        .footer-main-link { color: var(--primary); text-decoration: none; font-weight: 600; }
        .footer-main-link:hover { text-decoration: underline; }

        .hidden { display: none; }

        .success-actions { display: flex; flex-direction: column; gap: 12px; width: 100%; max-width: 300px; margin: 2rem auto 0; }
        .btn-preview-tab { background: #8b5cf6; color: white; }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>InfiniScan</h1>
            <p style="color: var(--text-muted); font-size: 0.9rem;">Arrange smoothly, Export perfectly</p>
        </header>

        <!-- View 1: Home -->
        <div id="home-view" class="view-section active">
            <div class="upload-box" id="drop-zone" onclick="document.getElementById('main-input').click()">
                <i class="fas fa-plus-circle" style="font-size: 3rem; color: var(--primary); margin-bottom: 1rem;"></i>
                <h2>Select Photos</h2>
                <p style="color: var(--text-muted); margin-top: 8px; line-height: 1.4;">
                    Drop the images to make PDF instantly<br>
                    <small>or tap here to start</small>
                </p>
                <input type="file" id="main-input" class="hidden" accept="image/*" multiple onchange="handleNewFiles(this.files)">
            </div>

            <!-- Ad Box on Home View -->
            <div class="ad-placeholder">
                <span class="ad-label">ADVERTISEMENT</span>
                <div class="ad-content">
                    <p>Space for Future Advertisements</p>
                    <small>Contact us to advertise here</small>
                </div>
            </div>
        </div>

        <!-- View 2: Editor -->
        <div id="editor-view" class="view-section">
            <div class="grid-container" id="sortable-grid"></div>
            
            <div class="action-bar">
                <div class="action-buttons-row">
                    <button class="btn btn-outline" onclick="resetApp()">Clear</button>
                    <button class="btn btn-primary" id="gen-btn" onclick="generatePDF()">Preview PDF</button>
                </div>
                <button class="btn btn-add-more" onclick="document.getElementById('add-more-input').click()">
                    <i class="fas fa-camera-retro"></i> Add More Photos
                </button>
                <input type="file" id="add-more-input" class="hidden" accept="image/*" multiple onchange="handleNewFiles(this.files)">
            </div>

            <!-- Ad Box on Editor View -->
            <div class="ad-placeholder">
                <span class="ad-label">ADVERTISEMENT</span>
                <div class="ad-content">
                    <p>Space for Future Advertisements</p>
                    <small>Contact us to advertise here</small>
                </div>
            </div>
        </div>

        <!-- View 3: Final -->
        <div id="success-view" class="view-section">
            <div style="text-align: center; background: var(--card-bg); padding: 3rem 2rem; border-radius: 24px; border: 1px solid var(--card-border); width: 100%; max-width: 450px;">
                <i class="fas fa-check-circle" style="font-size: 4rem; color: #10b981; margin-bottom: 1rem;"></i>
                <h2>PDF Ready!</h2>
                <div class="success-actions">
                    <button class="btn btn-primary" onclick="downloadPDF()">
                        <i class="fas fa-download"></i> Download Now
                    </button>
                    <button class="btn btn-preview-tab" onclick="previewPDFInTab()">
                        <i class="fas fa-eye"></i> Preview PDF (New Tab)
                    </button>
                    <button class="btn btn-outline" onclick="resetApp()">
                        <i class="fas fa-redo"></i> New Project
                    </button>
                </div>
            </div>

            <!-- Ad Box on Success View -->
            <div class="ad-placeholder">
                <span class="ad-label">ADVERTISEMENT</span>
                <div class="ad-content">
                    <p>Space for Future Advertisements</p>
                    <small>Contact us to advertise here</small>
                </div>
            </div>
        </div>
    </div>

    <!-- INFO MODAL -->
    <div id="info-modal" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal(null)">&times;</button>
            <h2 id="modal-title">Title</h2>
            <div id="modal-body" style="margin-top: 1.5rem; line-height: 1.7; color: var(--text-muted); white-space: pre-line; font-size: 0.95rem;"></div>
            <div id="modal-extra-actions"></div>
        </div>
    </div>

    <!-- CONTACT FORM MODAL -->
    <div id="form-modal" class="modal-overlay" onclick="closeFormModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeFormModal(null)">&times;</button>
            <h2>Contact Us</h2>
            <form id="contact-form" style="margin-top: 1.5rem;">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="user-name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="user-email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>Message</label>
                    <textarea id="user-message" class="form-input" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label style="display: flex; align-items: flex-start; gap: 10px; font-size: 0.8rem;">
                        <input type="checkbox" id="user-consent" required>
                        <span>I agree to the Privacy Policy.</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary" style="width:100%;" id="submit-form-btn">Submit Message</button>
            </form>
        </div>
    </div>

    <footer>
        <a href="#" class="footer-main-link">Infinite Corporation</a> | Founder: <strong>Ansh Soni</strong><br>
        <div class="footer-nav">
            <span onclick="openModal('About Us', aboutUsText)">About Us</span>
            <span onclick="openModal('Privacy Policy', privacyPolicyText)">Privacy Policy</span>
            <span onclick="openModal('Contact Us', contactUsText, true)">Contact Us</span>
        </div>
    </footer>

    <script>
        let items = [];
        let pdfBlob = null;
        let pdfUrl = null;
        const { jsPDF } = window.jspdf;

        // --- TEXT CONTENT ---
        const aboutUsText = `InfiniScan is a student-developed web application created for educational and productivity purposes.

The main goal of this application is to help users easily convert images into PDF files in a fast, simple, and user-friendly way without installing any software.

This project is built as a learning initiative and practical implementation of web technologies. It is not a registered company product or commercial enterprise.

We continuously improve this tool based on technical learning and user feedback, while keeping the application lightweight, accessible, and focused on essential features.

InfiniScan is designed mainly for students and general users who need a quick and reliable image-to-PDF solution.`;

        const privacyPolicyText = `We respect your privacy and are committed to protecting it.

This application does not require user registration and does not intentionally collect personal information such as name, phone number, address, or identity details.

Images and files uploaded by users are used only for the purpose of converting images into PDF files. All processing is performed automatically.

Uploaded files are not stored permanently on our servers. Any temporary data created during processing is automatically deleted after the task is completed.
We do not manually access, view, or share any user-uploaded content.

This application is provided "as is". While we take reasonable technical measures to ensure proper functioning, we do not guarantee that the service will always be error-free, uninterrupted, or free from data loss.

The user is fully responsible for the files they upload and how they use this service.
InfiniScan and its developer are not responsible for any data loss, file corruption, misuse, or damage that may occur during or after using this application.

Users are strongly advised not to upload sensitive, confidential, or personal documents.

This application may display advertisements and may use third-party services such as Google Ads. These third-party services may collect non-personal data according to their own privacy policies.

By using this application, you agree to this privacy policy and its terms.`;

        const contactUsText = `If you have any questions, suggestions, or feedback regarding this application, you can contact us using the form provided.

When you submit the contact form, the information you enter (such as name, email address, and message) is used only for the purpose of responding to your query or feedback.

This application is developed and maintained by a student. Responses are provided on a best-effort basis, and response time may vary.

Please do not submit sensitive, confidential, or personal information through the contact form.

By submitting the form, you confirm that the information provided by you is voluntary and accurate, and you agree to the Privacy Policy of this application.`;

        // --- DRAG AND DROP SETUP ---
        const dropZone = document.getElementById('drop-zone');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, e => {
                e.preventDefault();
                e.stopPropagation();
            }, false);
        });

        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, () => dropZone.classList.add('dragover'), false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, () => dropZone.classList.remove('dragover'), false);
        });

        dropZone.addEventListener('drop', e => {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleNewFiles(files);
        }, false);

        // --- CONTACT FORM SUBMISSION ---
        document.getElementById('contact-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const btn = document.getElementById('submit-form-btn');
            btn.disabled = true;
            btn.innerText = 'Submitting...';

            const scriptURL = 'https://script.google.com/macros/s/AKfycbyD5iiQSlMxLYo4EnIlv3aEjmNjS3va2aKy9dzPQKI7veaDum9xf2NzicrUm2n9yrAE/exec';

            const formData = new URLSearchParams();
            formData.append('name', document.getElementById('user-name').value);
            formData.append('email', document.getElementById('user-email').value);
            formData.append('message', document.getElementById('user-message').value);
            formData.append('consent', document.getElementById('user-consent').checked ? 'Yes' : 'No');

            try {
                await fetch(scriptURL, { 
                    method: 'POST', 
                    mode: 'no-cors', 
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: formData.toString() 
                });
                
                alert('Success! Your message has been sent.');
                document.getElementById('contact-form').reset();
                closeFormModal();
            } catch (err) {
                console.error('Submission error:', err);
                alert('Error connecting to the submission service.');
            } finally {
                btn.disabled = false;
                btn.innerText = 'Submit Message';
            }
        });

        // --- APP LOGIC ---
        function openModal(title, content, showForm = false) {
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-body').innerText = content;
            const extra = document.getElementById('modal-extra-actions');
            extra.innerHTML = '';
            if (showForm) {
                const b = document.createElement('button');
                b.className = 'btn-form-trigger'; b.innerText = 'Fill Contact Form';
                b.onclick = () => { closeModal(); openFormModal(); };
                extra.appendChild(b);
            }
            document.getElementById('info-modal').classList.add('active');
        }

        function closeModal() { document.getElementById('info-modal').classList.remove('active'); }
        function openFormModal() { document.getElementById('form-modal').classList.add('active'); }
        function closeFormModal() { document.getElementById('form-modal').classList.remove('active'); }

        async function handleNewFiles(files) {
            if (!files.length) return;
            for (let f of files) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    items.push({ id: Math.random(), data: e.target.result });
                    renderGrid();
                };
                reader.readAsDataURL(f);
            }
            document.getElementById('home-view').classList.remove('active');
            document.getElementById('editor-view').classList.add('active');
        }

        function renderGrid() {
            const g = document.getElementById('sortable-grid');
            g.innerHTML = '';
            items.forEach((item, i) => {
                const div = document.createElement('div');
                div.className = 'image-card';
                div.innerHTML = `<img src="${item.data}" class="img-preview">
                <div class="card-overlay"><span>P${i+1}</span><button class="btn-delete" onclick="removeItem(${i})">&times;</button></div>`;
                g.appendChild(div);
            });
        }

        function removeItem(i) { items.splice(i, 1); renderGrid(); if(!items.length) resetApp(); }

        async function generatePDF() {
            if (!items.length) return;
            const btn = document.getElementById('gen-btn');
            btn.innerText = 'Processing...';
            btn.disabled = true;

            setTimeout(() => {
                const pdf = new jsPDF();
                const width = pdf.internal.pageSize.getWidth();
                const height = pdf.internal.pageSize.getHeight();

                for (let i=0; i<items.length; i++) {
                    if(i>0) pdf.addPage();
                    pdf.addImage(items[i].data, 'JPEG', 10, 10, width - 20, height - 20);
                }
                pdfBlob = pdf.output('blob');
                
                if (pdfUrl) URL.revokeObjectURL(pdfUrl);
                pdfUrl = URL.createObjectURL(pdfBlob);

                btn.innerText = 'Preview PDF';
                btn.disabled = false;
                document.getElementById('editor-view').classList.remove('active');
                document.getElementById('success-view').classList.add('active');
            }, 500);
        }

        function downloadPDF() {
            if (!pdfUrl) return;
            const a = document.createElement('a'); 
            a.href = pdfUrl; 
            a.download = `InfiniScan_${Date.now()}.pdf`; 
            a.click();
        }

        function previewPDFInTab() {
            if (pdfUrl) {
                window.open(pdfUrl, '_blank');
            }
        }

        function resetApp() {
            items = []; 
            pdfBlob = null;
            if (pdfUrl) URL.revokeObjectURL(pdfUrl);
            pdfUrl = null;
            document.getElementById('main-input').value = '';
            document.getElementById('add-more-input').value = '';
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.getElementById('home-view').classList.add('active');
        }
    </script>
</body>
</html>

